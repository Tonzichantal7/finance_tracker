<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Settings - Finance Tracker</title>
    <link rel="stylesheet" href="styles.css">
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
</head>
<body>
    <div class="dashboard-container">
        <div id="sidebarContainer"></div>

        <!-- Main Content -->
        <main class="dashboard-main">
            <div id="headerContainer"></div>

            <section class="settings-section">
                <h1 class="page-title-main">Settings</h1>

                <!-- Settings Tabs -->
                <div class="settings-tabs">
                    <button class="settings-tab active" data-tab="profile">
                        <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                            <path d="M10 10C12.7614 10 15 7.76142 15 5C15 2.23858 12.7614 0 10 0C7.23858 0 5 2.23858 5 5C5 7.76142 7.23858 10 10 10Z" fill="currentColor"/>
                            <path d="M10 12C5.58172 12 2 14.6863 2 18V20H18V18C18 14.6863 14.4183 12 10 12Z" fill="currentColor"/>
                        </svg>
                        Profile
                    </button>
                    <button class="settings-tab" data-tab="preferences">
                        <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                            <path d="M10 12.5C11.3807 12.5 12.5 11.3807 12.5 10C12.5 8.61929 11.3807 7.5 10 7.5C8.61929 7.5 7.5 8.61929 7.5 10C7.5 11.3807 8.61929 12.5 10 12.5Z" fill="currentColor"/>
                            <path d="M16.0917 13.3083L15.8333 13.5167L13.6917 15.6583L13.4833 15.9167C13.175 16.2917 12.6583 16.325 12.3083 15.9917L10.575 14.4167C10.4333 14.3 10.2417 14.2583 10.0583 14.3L9.39167 14.4583C8.875 14.575 8.325 14.3083 8.04167 13.8333L7.16667 12.325C6.925 11.9083 7.01667 11.3833 7.375 11.0833L8.04167 10.5167C8.19167 10.3917 8.28333 10.2 8.29167 10L8.43333 9.33333C8.53333 8.81667 8.3 8.29167 7.875 8.04167L6.36667 7.16667C5.95 6.925 5.425 7.01667 5.125 7.375L4.55833 8.04167C4.43333 8.19167 4.24167 8.28333 4.04167 8.29167L3.375 8.43333C2.85833 8.53333 2.33333 8.3 2.08333 7.875L1.20833 6.36667C0.966667 5.95 1.05833 5.425 1.41667 5.125L2.08333 4.55833C2.23333 4.43333 2.275 4.24167 2.20833 4.05833L1.80833 2.66667C1.64167 2.19167 1.88333 1.66667 2.35833 1.5L3.75 1.1C4.225 0.933333 4.75 1.175 4.91667 1.65L5.25 2.70833C5.31667 2.89167 5.45833 3.03333 5.64167 3.1L6.7 3.43333C7.175 3.6 7.40833 4.11667 7.24167 4.59167L6.84167 5.98333C6.775 6.16667 6.81667 6.35833 6.94167 6.50833L7.50833 7.175C7.80833 7.53333 7.71667 8.05833 7.3 8.3L8.175 9.80833C8.41667 10.225 8.325 10.75 7.96667 11.05L7.3 11.6167C7.15 11.7417 7.05833 11.9333 7.05 12.1333L6.90833 12.8C6.80833 13.3167 7.04167 13.8417 7.46667 14.0917L8.975 14.9667C9.39167 15.2083 9.91667 15.1167 10.2167 14.7583L10.7833 14.0917C10.9333 13.9667 11.125 13.925 11.3083 13.9917L12.7 14.3917C13.175 14.5583 13.7 14.3167 13.8667 13.8417L14.2667 12.45C14.3333 12.2667 14.475 12.125 14.6583 12.0583L15.7167 11.725C16.1917 11.5583 16.7167 11.8 16.8833 12.275L17.2833 13.6667C17.35 13.85 17.3083 14.0417 17.1833 14.1917L16.6167 14.8583C16.3167 15.2167 16.4083 15.7417 16.825 15.9833L18.3333 16.8583C18.75 17.1 18.8417 17.625 18.4833 17.925L17.8167 18.4917C17.6667 18.6167 17.625 18.8083 17.6917 18.9917L18.0917 20.3833C18.2583 20.8583 18.0167 21.3833 17.5417 21.55L16.15 21.95C15.675 22.1167 15.15 21.875 14.9833 21.4L14.65 20.3417C14.5833 20.1583 14.4417 20.0167 14.2583 19.95L13.2 19.6167C12.725 19.45 12.4917 18.9333 12.6583 18.4583L13.0583 17.0667C13.125 16.8833 13.0833 16.6917 12.9583 16.5417L12.3917 15.875C12.0917 15.5167 12.1833 14.9917 12.6 14.75L13.775 14.0833" fill="currentColor"/>
                        </svg>
                        Preferences
                    </button>
                    <button class="settings-tab" data-tab="account">
                        <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                            <path d="M10 18C14.4183 18 18 14.4183 18 10C18 5.58172 14.4183 2 10 2C5.58172 2 2 5.58172 2 10C2 14.4183 5.58172 18 10 18Z" stroke="currentColor" stroke-width="2"/>
                            <path d="M10 6V10M10 14H10.01" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        Account
                    </button>
                </div>

                <!-- Profile Tab -->
                <div class="settings-tab-content active" id="profileTab">
                    <div class="settings-card">
                        <h3 class="settings-subtitle">Profile Information</h3>
                        <form id="profileForm">
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="displayName">Full Name</label>
                                    <input type="text" id="displayName" required>
                                </div>
                                <div class="form-group">
                                    <label for="email">Email</label>
                                    <input type="email" id="email" disabled>
                                </div>
                            </div>
                            <div class="form-group">
                                <label>Password</label>
                                <div class="password-section">
                                    <p class="password-hint">Change your password</p>
                                    <button type="button" class="btn-change-password" id="changePasswordBtn">
                                        <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                                            <path d="M12 8V5.33333C12 3.49238 10.5076 2 8.66667 2H7.33333C5.49238 2 4 3.49238 4 5.33333V8M6 14H10C11.1046 14 12 13.1046 12 12V9.33333C12 8.22876 11.1046 7.33333 10 7.33333H6C4.89543 7.33333 4 8.22876 4 9.33333V12C4 13.1046 4.89543 14 6 14Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                                        </svg>
                                        Change Password
                                    </button>
                                </div>
                            </div>
                            <button type="submit" class="btn-primary">Update Profile</button>
                        </form>
                    </div>
                </div>

                <!-- Preferences Tab -->
                <div class="settings-tab-content" id="preferencesTab">
                    <div class="settings-card">
                        <h3 class="settings-subtitle">App Preferences</h3>
                        
                        <div class="preference-item">
                            <label for="currency" class="preference-label">Currency</label>
                            <select id="currency" class="preference-select">
                                <option value="USD">US Dollar (USD)</option>
                                <option value="EUR">Euro (EUR)</option>
                                <option value="GBP">British Pound (GBP)</option>
                                <option value="JPY">Japanese Yen (JPY)</option>
                                <option value="CAD">Canadian Dollar (CAD)</option>
                                <option value="AUD">Australian Dollar (AUD)</option>
                                <option value="CHF">Swiss Franc (CHF)</option>
                                <option value="CNY">Chinese Yuan (CNY)</option>
                                <option value="INR">Indian Rupee (INR)</option>
                                <option value="BRL">Brazilian Real (BRL)</option>
                            </select>
                        </div>

                        <div class="preference-item">
                            <div class="preference-header">
                                <div class="preference-header-left">
                                    <svg class="preference-icon" width="20" height="20" viewBox="0 0 20 20" fill="none">
                                        <path d="M10 2C6.68629 2 4 4.68629 4 8C4 11.3137 6.68629 14 10 14C13.3137 14 16 11.3137 16 8C16 4.68629 13.3137 2 10 2Z" fill="#6B7280"/>
                                        <path d="M10 15C6.68629 15 3.58152 16.2143 1.33333 18.3333C2.69048 15.8095 6.14286 14 10 14C13.8571 14 17.3095 15.8095 18.6667 18.3333C16.4185 16.2143 13.3137 15 10 15Z" fill="#6B7280"/>
                                    </svg>
                                    <div>
                                        <label for="emailNotifications" class="preference-label">Email Notifications</label>
                                        <p class="preference-description">Get notified about transactions</p>
                                    </div>
                                </div>
                                <label class="toggle-switch">
                                    <input type="checkbox" id="emailNotifications">
                                    <span class="toggle-slider"></span>
                                </label>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Account Tab -->
                <div class="settings-tab-content" id="accountTab">
                    <div class="settings-card danger-zone">
                        <h3 class="settings-subtitle">Delete Account</h3>
                        <p class="danger-text">Once you delete your account, there is no going back.</p>
                        <button class="btn-danger" id="deleteAccountBtn">Delete Account</button>
                    </div>
                </div>
            </section>

    <!-- Change Password Modal -->
    <div class="modal" id="passwordModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Change Password</h2>
                <button class="modal-close" id="closePasswordModal">&times;</button>
            </div>
            <form id="passwordForm">
                <div class="form-group">
                    <label for="currentPassword">Current Password</label>
                    <input type="password" id="currentPassword" required>
                </div>
                <div class="form-group">
                    <label for="newPassword">New Password</label>
                    <input type="password" id="newPassword" required minlength="6">
                </div>
                <div class="form-group">
                    <label for="confirmPassword">Confirm New Password</label>
                    <input type="password" id="confirmPassword" required minlength="6">
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn-secondary" id="cancelPassword">Cancel</button>
                    <button type="submit" class="btn-primary">Change Password</button>
                </div>
            </form>
        </div>
    </div>
        </main>
    </div>

    <script src="security-utils.js"></script>
    <script src="firebase-config.js"></script>
    <script>
        // Authentication protection
        auth.onAuthStateChanged((user) => {
            if (!user) {
                window.location.replace('index.html');
            }
        });
    </script>
    <script src="sidebar.js"></script>
    <script src="common.js"></script>
    <script src="settings.js"></script>
</body>
</html>

